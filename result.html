<!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Skill Centerr | परिणाम कार्ड</title>
  <meta name="description" content="अपने QR लिंक से परिणाम देखें।" />
  <meta name="theme-color" content="#4F0A5A" />
  <style>
    :root{ --primary:#4F0A5A; --accent:#F2CFEE; --ink:#231633; --muted:#6a5b79; --shadow:0 8px 24px rgba(35,22,51,.12); --radius:16px; --max:900px }
    *{box-sizing:border-box}
    body{margin:0; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; color:var(--ink); background:linear-gradient(180deg, white, color-mix(in oklab, var(--accent) 18%, white 82%));}
    .wrap{max-width:var(--max); margin:0 auto; padding:18px}
    header{display:flex; align-items:center; gap:12px; padding:12px 0}
    .logo{width:40px; height:40px; border-radius:50%; background: radial-gradient(90% 90% at 20% 20%, var(--accent), transparent 60%), radial-gradient(90% 90% at 80% 80%, color-mix(in oklab, var(--primary) 70%, black 5%), transparent 60%), var(--primary); box-shadow: inset 0 0 0 2px #ffffffaa, 0 6px 14px rgba(79,10,90,.35)}
    h1{font-family:Poppins, Inter; font-size:clamp(22px, 4vw, 28px); margin:0; color:var(--primary)}
    .card{background:#fff; border-radius:var(--radius); box-shadow:var(--shadow); border:1px solid color-mix(in oklab, var(--primary) 12%, white 88%); padding:16px}
    .grid{display:grid; gap:16px; grid-template-columns:1fr 1fr}
    @media (max-width:700px){ .grid{grid-template-columns:1fr} }
    .kv{display:grid; grid-template-columns:140px 1fr; gap:8px}
    .kv div{padding:8px 10px; border-radius:10px}
    .k{background: color-mix(in oklab, var(--accent) 35%, white 65%); color:var(--primary); font-weight:700}
    .v{background:#fff; border:1px dashed color-mix(in oklab, var(--primary) 15%, white 85%)}
    .marks table{width:100%; border-collapse:collapse}
    .marks th, .marks td{border:1px solid color-mix(in oklab, var(--primary) 12%, white 88%); padding:8px; text-align:left}
    .marks th{background: color-mix(in oklab, var(--accent) 25%, white 75%); color:var(--primary)}
    .cta{display:flex; flex-wrap:wrap; gap:8px; margin-top:12px}
    .btn{display:inline-flex; align-items:center; gap:8px; padding:10px 14px; border-radius:12px; border:1px solid color-mix(in oklab, var(--primary) 20%, white 80%); cursor:pointer; font-weight:600}
    .btn.primary{background: linear-gradient(135deg, var(--primary), color-mix(in oklab, var(--primary) 70%, black 10%)); color:#fff; border-color:transparent}
    .note{color:var(--muted); font-size:14px}
    footer{margin-top:16px; text-align:center; color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo" aria-hidden="true"></div>
      <div>
        <h1>Skill Centerr · परिणाम कार्ड</h1>
        <div class="note">QR स्कैन करने के बाद यह पेज खुलता है। नीचे आपकी पूर्ण जानकारी व परिणाम दिया है।</div>
      </div>
    </header>

    <div class="card" id="card">
      <div class="grid">
        <section>
          <div class="kv"><div class="k">विद्यार्थी</div><div class="v" id="name">—</div></div>
          <div class="kv"><div class="k">आईडी</div><div class="v" id="id">—</div></div>
          <div class="kv"><div class="k">रोल</div><div class="v" id="roll">—</div></div>
          <div class="kv"><div class="k">कक्षा</div><div class="v" id="cls">—</div></div>
          <div class="kv"><div class="k">बैच</div><div class="v" id="batch">—</div></div>
          <div class="kv"><div class="k">परिणाम तिथि</div><div class="v" id="date">—</div></div>
        </section>
        <section class="marks">
          <table>
            <thead><tr><th>विषय</th><th>अंक</th></tr></thead>
            <tbody id="marks"></tbody>
            <tfoot>
              <tr><th>कुल</th><th id="total">—</th></tr>
              <tr><th>कुल में से</th><th id="outof">—</th></tr>
              <tr><th>ग्रेड</th><th id="grade">—</th></tr>
            </tfoot>
          </table>
        </section>
      </div>
      <p class="note" id="remarks" style="margin-top:8px"></p>

      <div class="cta">
        <button class="btn primary" onclick="window.print()">प्रिंट / PDF</button>
        <button class="btn" onclick="shareLink()">लिंक शेयर करें</button>
        <button class="btn" onclick="copyLink()">लिंक कॉपी करें</button>
      </div>
    </div>

    <footer>© <span id="y"></span> Skill Centerr · Orbital Skill Development</footer>
  </div>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    const sheetURL = "https://docs.google.com/spreadsheets/d/1vpWiNeyz4YUDSkTsgrekglJts1cP8ByolR-QnOHzwo0/gviz/tq?tqx=out:csv";
    const q = new URLSearchParams(location.search);
    const wantedId = q.get('id');

    async function load() {
      try {
        const res = await fetch(sheetURL);
        const csv = await res.text();
        const rows = csv.split("\n").map(r => r.split(","));
        const headers = rows[0].map(h => h.trim());
        const data = rows.slice(1).map(r => {
          const obj = {};
          headers.forEach((h, i) => obj[h] = r[i] ? r[i].trim() : "");
          return obj;
        });

        const stu = data.find(s => s["Student id"] === wantedId);
        if (!stu) {
          alert("अमान्य/गायब आईडी। लिंक स्वरूप: result.html?id=SC-2025-001");
          document.getElementById("name").textContent = "रिकॉर्ड नहीं मिला";
          return;
        }

        set("name", stu["Name"]);
        set("id", stu["Student id"]);
        set("roll", stu["Roll"]);
        set("cls", stu["Class"]);
        set("batch", stu["Batch"]);
        set("date", stu["Date of Issue"]);
        set("total", stu["Total"]);
        set("outof", stu["Out of"]);
        set("grade", stu["Grade"]);
        set("remarks", "टिप्पणी: " + (stu["Remarks"] || "—"));

        const tbody = document.getElementById("marks");
        tbody.innerHTML = "";
        Object.keys(stu).forEach(key => {
          if (!["Name","Father Name","Student id","Roll","Class","Batch","Date of Issue","Total","Out of","Grade","Remarks"].includes(key) && stu[key]) {
            const tr = document.createElement("tr");
            tr.innerHTML = `<td>${key}</td><td>${stu[key]}</td>`;
            tbody.appendChild(tr);
          }
        });
      } catch (e) {
        alert("Sheet डेटा लोड नहीं हुआ!");
      }
    }

    function set(id, val) {
      document.getElementById(id).textContent = val;
    }

    function copyLink() {
      navigator.clipboard.writeText(location.href).then(() => alert("लिंक कॉपी हो गया"));
    }

    function shareLink() {
      if (navigator.share) {
        navigator.share({ title: document.title, url: location.href });
      } else {
        copyLink();
      }
    }

    load();
  </script>
</body>
</html>
