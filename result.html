<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Orbital Skill Development ¬∑ Result</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9f6ff;
      color: #222;
      text-align: center;
      padding: 20px;
    }
    h2 {
      color: #4A148C;
      margin-bottom: 5px;
    }
    h3 { color: #6A1B9A; margin-top: 5px; }
    .card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      max-width: 800px;
      margin: 20px auto;
      text-align: left;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
    }
    th { background: #ede7f6; color: #4A148C; text-align: left; }
    .btns { text-align: center; margin-top: 15px; }
    button {
      background: #6A1B9A;
      color: #fff;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      margin: 5px;
      cursor: pointer;
    }
    button:hover { background: #8E24AA; }
    .notfound { color: red; font-weight: bold; }
  </style>
</head>
<body>

  <h2>Orbital Skill Development</h2>
  <h3>Result</h3>
  <div id="result">‚è≥ Loading data...</div>

  <script>
    const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT2MpDA6ryyZb68pkzM6ZABrkuqdT3_-6Y2mR9qu8zp6nqTWcUmXzkGRiQizEOAfy4HBPzv_zILRXN-/pub?gid=0&single=true&output=csv";

    async function fetchData() {
      const res = await fetch(sheetURL);
      const text = await res.text();
      const rows = text.trim().split("\n").map(r => r.split(","));
      const headers = rows[0].map(h => h.trim());
      return rows.slice(1).map(r => {
        const obj = {};
        headers.forEach((h, i) => obj[h] = (r[i] || "").trim());
        return obj;
      });
    }

    function showData(rec) {
      let subjects = "";
      for (let i = 1; i <= 8; i++) {
        const s = rec[`Subject ${i}`];
        const m = rec[`Marks ${i}`];
        if (s) subjects += `<tr><td>${s}</td><td>${m || "‚Äî"}</td></tr>`;
      }

      document.getElementById("result").innerHTML = `
        <div class="card">
          <table>
            <tr><th>Name</th><td>${rec["Name"]}</td></tr>
            <tr><th>Father Name</th><td>${rec["Father Name"]}</td></tr>
            <tr><th>Student ID</th><td>${rec["Student id"]}</td></tr>
            <tr><th>Roll No</th><td>${rec["Roll No"]}</td></tr>
            <tr><th>Class</th><td>${rec["Class"]}</td></tr>
            <tr><th>Batch</th><td>${rec["Batch"]}</td></tr>
            <tr><th>Course</th><td>${rec["Course"]}</td></tr>
            <tr><th>Date of Issue</th><td>${rec["Date of Issue"]}</td></tr>
          </table>

          <h3>Subject-wise Marks</h3>
          <table>
            <tr><th>Subject</th><th>Marks</th></tr>
            ${subjects}
            <tr><th>Total</th><td>${rec["Total"] || "‚Äî"}</td></tr>
            <tr><th>Out of</th><td>${rec["Out of"] || "‚Äî"}</td></tr>
            <tr><th>Grade</th><td>${rec["Grade"] || "‚Äî"}</td></tr>
          </table>

          <div class="btns">
            <button onclick="window.print()">üñ®Ô∏è Print / PDF</button>
            <button onclick="copyLink()">üìã Copy Link</button>
          </div>
        </div>
      `;
    }

    function copyLink() {
      navigator.clipboard.writeText(window.location.href);
      alert("Link copied!");
    }

    function showError(id) {
      document.getElementById("result").innerHTML = `<p class='notfound'>‚ùå Record not found (${id})</p>`;
    }

    (async () => {
      const id = new URLSearchParams(window.location.search).get("id");
      if (!id) return showError("Missing ID");
      const data = await fetchData();
      const rec = data.find(r => (r["Student id"] || "").toLowerCase() === id.toLowerCase());
      if (rec) showData(rec);
      else showError(id);
    })();
  </script>

  <footer>
    ¬© 2025 Orbital Skill Development | Powered by osifbd.github.io
  </footer>

</body>
</html>
