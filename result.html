<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Orbital Skill Development ¬∑ Result</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f9f6ff; margin: 0; padding: 20px; color: #333; }
    .wrap { max-width: 850px; margin: 30px auto; background: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
    h1 { text-align: center; color: #4F0A5A; margin-bottom: 10px; }
    h3 { text-align: center; color: #666; margin-top: 0; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
    th { background: #ede7f6; color: #4F0A5A; }
    .notfound { color: red; text-align: center; font-weight: bold; margin-top: 20px; }
    .btn { display: block; margin: 20px auto; background: #4F0A5A; color: white; border: none; padding: 10px 16px; border-radius: 8px; cursor: pointer; }
  </style>
</head>
<body>
  <div class="wrap" id="wrap">
    <h1>Orbital Skill Development</h1>
    <h3>Result</h3>
    <div id="result">‚è≥ Loading data...</div>
    <button class="btn" onclick="window.print()">üñ®Ô∏è Print / PDF</button>
  </div>
  <script>
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT2MpDA6ryyZb68pkzM6ZABrkuqdT3_-6Y2mR9qu8zp6nqTWcUmXzkGRiQizEOAfy4HBPzv_zILRXN-/pub?output=csv";

    async function fetchData() {
      const res = await fetch(sheetUrl);
      const text = await res.text();
      const rows = text.trim().split("\n").map(r => r.split(","));
      const headers = rows[0].map(h => h.trim());
      return rows.slice(1).map(r => {
        const obj = {};
        headers.forEach((h, i) => obj[h] = (r[i] || "").trim());
        return obj;
      });
    }

    function showData(rec) {
      let subjHTML = "";
      for (let i = 1; i <= 8; i++) {
        const s = rec[`Subject ${i}`];
        const m = rec[`Marks ${i}`];
        if (s || m) {
          subjHTML += `<tr><td>${s || "‚Äî"}</td><td>${m || "‚Äî"}</td></tr>`;
        }
      }
      document.getElementById("result").innerHTML = `
        <table>
          <tr><th>Name</th><td>${rec["Name"] || "‚Äî"}</td></tr>
          <tr><th>Father Name</th><td>${rec["Father Name"] || "‚Äî"}</td></tr>
          <tr><th>Student ID</th><td>${rec["Student id"] || "‚Äî"}</td></tr>
          <tr><th>Roll No</th><td>${rec["Roll No"] || "‚Äî"}</td></tr>
          <tr><th>Class</th><td>${rec["Class"] || "‚Äî"}</td></tr>
          <tr><th>Batch</th><td>${rec["Batch"] || "‚Äî"}</td></tr>
          <tr><th>Course</th><td>${rec["Course"] || "‚Äî"}</td></tr>
          <tr><th>Date of Issue</th><td>${rec["Date of Issue"] || "‚Äî"}</td></tr>
        </table>
        <h3 style="margin-top:25px;">Subject-wise Marks</h3>
        <table>
          <tr><th>Subject</th><th>Marks</th></tr>
          ${subjHTML || `<tr><td colspan="2">No subject data available</td></tr>`}
          <tr><th>Total</th><td>${rec["Total"] || "‚Äî"}</td></tr>
          <tr><th>Out of</th><td>${rec["Out of"] || "‚Äî"}</td></tr>
          <tr><th>Grade</th><td>${rec["Grade"] || "‚Äî"}</td></tr>
        </table>
      `;
    }

    function showError(id) {
      document.getElementById("result").innerHTML = `<p class="notfound">‚ùå Record not found (${id})</p>`;
    }

    (async () => {
      const idParam = new URLSearchParams(window.location.search).get("id");
      if (!idParam) {
        showError("Missing ID");
        return;
      }
      const data = await fetchData();
      const rec = data.find(r => (r["Student id"] || "").toLowerCase() === idParam.toLowerCase());
      if (rec) showData(rec);
      else showError(idParam);
    })();
  </script>

  <footer>
    ¬© 2025 Orbital Skill Development | Powered by osifbd.github.io
  </footer>
</body>
</html>
