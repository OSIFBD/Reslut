<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Orbital Skill Development ¬∑ Result Card</title>
  <style>
    body {
      font-family: "Poppins", Arial, sans-serif;
      background: #f8f7fb;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    .wrap {
      max-width: 850px;
      margin: 30px auto;
      background: #fff;
      border-radius: 16px;
      padding: 25px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    }
    header {
      text-align: center;
      margin-bottom: 25px;
    }
    header h1 {
      margin: 0;
      font-size: 26px;
      color: #4F0A5A;
    }
    header p {
      margin: 5px 0 0;
      font-size: 16px;
      color: #777;
      font-weight: 500;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: left;
    }
    th {
      background: #f3e6f9;
      color: #4F0A5A;
    }
    .notfound {
      color: red;
      text-align: center;
      font-weight: bold;
      margin: 20px 0;
    }
    .btn {
      margin-top: 20px;
      background: #4F0A5A;
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
    }
    footer {
      text-align: center;
      margin-top: 20px;
      color: #777;
      font-size: 13px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Orbital Skill Development</h1>
      <p>Result Card</p>
    </header>

    <div id="result"><p style="text-align:center;color:#777;">Loading data...</p></div>

    <button class="btn" onclick="window.print()">üñ®Ô∏è Print / PDF</button>
  </div>

  <footer>¬© 2025 Orbital Skill Development | Powered by osifbd.github.io</footer>

  <script>
    const params = new URLSearchParams(window.location.search);
    const studentId = params.get('id');
    // ‚úÖ Your working Google Sheet CSV link
    const sheetUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT2MpDA6ryyZb68pkzM6ZABrkuqdT3_-6Y2mR9qu8zp6nqTWcUmXzkGRiQizEOAfy4HBPzv_zILRXN-/pub?gid=0&single=true&output=csv";

    async function load() {
      try {
        const res = await fetch(sheetUrl);
        const text = await res.text();
        const rows = text.trim().split('\n').map(r => r.split(','));
        const headers = rows.shift().map(h => h.trim());
        const data = rows.map(r => {
          const obj = {};
          headers.forEach((h, i) => obj[h] = r[i] ? r[i].trim() : "");
          return obj;
        });

        const rec = data.find(r => (r["Student id"] || "").toLowerCase() === (studentId || "").toLowerCase());
        const container = document.getElementById("result");

        if (!rec) {
          container.innerHTML = `<p class="notfound">‚ùå Invalid or record not found (${studentId})</p>`;
          return;
        }

        // Subjects & Marks ‚Äî auto-detect how many exist
        let subjectsHTML = "";
        for (let i = 1; i <= 10; i++) {
          const subj = rec[`Subject ${i}`];
          const mark = rec[`Marks ${i}`];
          if (subj && mark) subjectsHTML += `<tr><td>${subj}</td><td>${mark}</td></tr>`;
        }

        container.innerHTML = `
          <table>
            <tr><th>Student Name</th><td>${rec["Name"]}</td></tr>
            <tr><th>Father's Name</th><td>${rec["Father Name"]}</td></tr>
            <tr><th>Student ID</th><td>${rec["Student id"]}</td></tr>
            <tr><th>Roll No</th><td>${rec["Roll No"]}</td></tr>
            <tr><th>Class</th><td>${rec["Class"]}</td></tr>
            <tr><th>Batch</th><td>${rec["Batch"]}</td></tr>
            <tr><th>Course</th><td>${rec["Course"]}</td></tr>
            <tr><th>Date of Issue</th><td>${rec["Date of Issue"]}</td></tr>
          </table>

          <h3 style="margin-top:25px; color:#4F0A5A;">Subject Marks</h3>
          <table>
            <tr><th>Subject</th><th>Marks</th></tr>
            ${subjectsHTML || `<tr><td colspan="2">No subject data available</td></tr>`}
            <tr><th>Total</th><td>${rec["Total"] || "‚Äî"}</td></tr>
            <tr><th>Out of</th><td>${rec["Out of"] || "‚Äî"}</td></tr>
            <tr><th>Grade</th><td>${rec["Grade"] || "‚Äî"}</td></tr>
          </table>
        `;
      } catch (err) {
        document.getElementById("result").innerHTML = `<p class="notfound">‚ö†Ô∏è Error loading data</p>`;
        console.error(err);
      }
    }

    load();
  </script>
</body>
</html>
