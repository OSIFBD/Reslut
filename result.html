<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Skill Centerr ¬∑ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§ï‡§æ‡§∞‡•ç‡§°</title>
  <style>
    body { font-family: 'Noto Sans Devanagari', Arial, sans-serif; background:#faf5ff; padding:20px; text-align:center; }
    h2 { color:#4a148c; }
    .card { background:white; padding:20px; margin:30px auto; border-radius:16px; max-width:700px; box-shadow:0 5px 15px rgba(0,0,0,0.1); text-align:left; }
    table { width:100%; border-collapse:collapse; margin-top:10px; }
    th, td { border:1px solid #e1bee7; padding:8px; }
    th { background:#f3e5f5; color:#4a148c; text-align:left; }
    .notfound { color:red; font-weight:bold; text-align:center; }
    button { background:#7b1fa2; color:white; border:none; padding:10px 16px; border-radius:8px; margin:5px; cursor:pointer; }
  </style>
</head>
<body>
  <h2>üéì Skill Centerr ¬∑ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§ï‡§æ‡§∞‡•ç‡§°</h2>
  <div id="result">‚è≥ ‡§°‡•á‡§ü‡§æ ‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>

  <script>
    https://docs.google.com/spreadsheets/d/e/2PACX-1vT2MpDA6ryyZb68pkzM6ZABrkuqdT3_-6Y2mR9qu8zp6nqTWcUmXzkGRiQizEOAfy4HBPzv_zILRXN-/pub?gid=0&single=true&output=csv
    const params = new URLSearchParams(window.location.search);
    const id = params.get('id');

    async function fetchData() {
      const res = await fetch(sheetURL);
      const text = await res.text();
      const rows = text.trim().split('\n').map(r => r.split(','));
      const headers = rows[0].map(h => h.trim());
      const data = rows.slice(1).map(r => {
        const obj = {};
        headers.forEach((h, i) => obj[h] = (r[i] || "").trim());
        return obj;
      });
      return data;
    }

    function showRecord(rec) {
      let subjects = "";
      for (let i=1;i<=10;i++){
        if (rec[`Subject ${i}`]) {
          subjects += `<tr><td>${rec[`Subject ${i}`]}</td><td>${rec[`Marks ${i}`]}</td></tr>`;
        }
      }
      document.getElementById("result").innerHTML = `
        <div class="card">
          <table>
            <tr><th>‡§®‡§æ‡§Æ</th><td>${rec["Name"]}</td></tr>
            <tr><th>‡§™‡§ø‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ</th><td>${rec["Father Name"]}</td></tr>
            <tr><th>‡§Ü‡§à‡§°‡•Ä</th><td>${rec["Student id"]}</td></tr>
            <tr><th>‡§∞‡•ã‡§≤</th><td>${rec["Roll No"]}</td></tr>
            <tr><th>‡§ï‡§ï‡•ç‡§∑‡§æ</th><td>${rec["Class"]}</td></tr>
            <tr><th>‡§¨‡•à‡§ö</th><td>${rec["Batch"]}</td></tr>
            <tr><th>‡§ï‡•ã‡§∞‡•ç‡§∏</th><td>${rec["Course"]}</td></tr>
            <tr><th>‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§§‡§ø‡§•‡§ø</th><td>${rec["Date of Issue"]}</td></tr>
          </table>
          <h3 style="color:#6a1b9a;">‡§µ‡§ø‡§∑‡§Ø‡§µ‡§æ‡§∞ ‡§Ö‡§Ç‡§ï</h3>
          <table>
            <tr><th>‡§µ‡§ø‡§∑‡§Ø</th><th>‡§Ö‡§Ç‡§ï</th></tr>
            ${subjects || `<tr><td colspan="2">‡§Ö‡§Ç‡§ï ‡§°‡•á‡§ü‡§æ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç</td></tr>`}
            <tr><th>‡§ï‡•Å‡§≤</th><td>${rec["Total"]}</td></tr>
            <tr><th>‡§ï‡•Å‡§≤ ‡§Æ‡•á‡§Ç ‡§∏‡•á</th><td>${rec["Out of"]}</td></tr>
            <tr><th>‡§ó‡•ç‡§∞‡•á‡§°</th><td>${rec["Grade"]}</td></tr>
          </table>
          <button onclick="window.print()">üñ®Ô∏è ‡§™‡•ç‡§∞‡§ø‡§Ç‡§ü / PDF</button>
        </div>`;
    }

    (async () => {
      if (!id) {
        document.getElementById("result").innerHTML = `<p class="notfound">‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø/‡§ó‡§æ‡§Ø‡§¨ ‡§Ü‡§à‡§°‡•Ä‡•§ ‡§≤‡§ø‡§Ç‡§ï ‡§∏‡•ç‡§µ‡§∞‡•Ç‡§™: result.html?id=OSD_025080013</p>`;
        return;
      }
      const data = await fetchData();
      const rec = data.find(r => r["Student id"].trim().toLowerCase() === id.trim().toLowerCase());
      if (rec) showRecord(rec);
      else document.getElementById("result").innerHTML = `<p class="notfound">‡§Ö‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§Ø‡§æ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ</p>`;
    })();
  </script>
</body>
</html>

